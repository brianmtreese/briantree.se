<!-- {%- if site.ads.size > 0 -%}
<div id="shop-ad" class="shop-ad" style="display: none">
	<button class="shop-ad__close" aria-label="Close shop ad">&times;</button>
	<a href="#" class="shop-ad__link" target="_blank" rel="noopener">
		<div class="shop-ad__image-wrapper">
			<img class="shop-ad__image" src="" alt="" loading="lazy" />
		</div>
		<div class="shop-ad__content">
			<div class="shop-ad__badge">Shop</div>
			<h3 class="shop-ad__title"></h3>
			<p class="shop-ad__description"></p>
			<span class="shop-ad__cta">Shop Now â†’</span>
		</div>
	</a>
</div>

<script>
	(function() {
	  const ads = [
	    {%- for ad in site.ads -%}
	    {
	      title: {{ ad.title | jsonify }},
	      description: {{ ad.description | jsonify }},
	      url: {{ ad.url | jsonify }},
	      {%- if ad.images -%}
	      images: [{%- for img in ad.images -%}{{ img | jsonify }}{%- unless forloop.last -%}, {%- endunless -%}{%- endfor -%}],
	      {%- endif -%}
	      {%- if ad.image -%}
	      image: {{ ad.image | jsonify }},
	      {%- endif -%}
	    }{%- unless forloop.last -%},{%- endunless -%}
	    {%- endfor -%}
	  ];

	  const shopAd = document.getElementById('shop-ad');
	  const shopAdLink = shopAd.querySelector('.shop-ad__link');
	  const shopAdImage = shopAd.querySelector('.shop-ad__image');
	  const shopAdTitle = shopAd.querySelector('.shop-ad__title');
	  const shopAdDescription = shopAd.querySelector('.shop-ad__description');
	  const closeButton = shopAd.querySelector('.shop-ad__close');

	  // Get random image from ad (supports both images array and single image)
	  function getRandomImage(ad) {
	    if (ad.images && ad.images.length > 0) {
	      // Multiple images - randomly select one
	      const randomImageIndex = Math.floor(Math.random() * ad.images.length);
	      return ad.images[randomImageIndex];
	    } else if (ad.image) {
	      // Single image - use it
	      return ad.image;
	    }
	    return '';
	  }

	  // Select random ad
	  function showRandomAd() {
	    const randomIndex = Math.floor(Math.random() * ads.length);
	    const ad = ads[randomIndex];
	    const selectedImage = getRandomImage(ad);

	    shopAdLink.href = ad.url;
	    shopAdImage.src = selectedImage;
	    shopAdImage.alt = ad.title;
	    shopAdTitle.textContent = ad.title;
	    shopAdDescription.textContent = ad.description.substring(0, 100) + (ad.description.length > 100 ? '...' : '');

	    // Show the ad with animation
	    shopAd.style.display = 'block';
	    setTimeout(() => {
	      shopAd.classList.add('shop-ad--visible');
	    }, 10);
	  }

	  // Close button functionality
	  closeButton.addEventListener('click', function(e) {
	    e.preventDefault();
	    e.stopPropagation();
	    closeAd();
	  });

	  function closeAd() {
	    shopAd.classList.remove('shop-ad--visible');
	    setTimeout(() => {
	      shopAd.style.display = 'none';
	    }, 300);
	  }

	  // Track clicks
	  shopAdLink.addEventListener('click', function() {
	    // You can add analytics tracking here
	    // gtag('event', 'click', { 'event_category': 'shop_ad', 'event_label': ad.title });
	  });

	  // Show ad after a delay (adjust timing as needed)
	  // Wait for page to load, then show after 3 seconds
	  if (document.readyState === 'loading') {
	    document.addEventListener('DOMContentLoaded', function() {
	      setTimeout(showRandomAd, 3000);
	    });
	  } else {
	    setTimeout(showRandomAd, 3000);
	  }
	})();
</script>
{%- endif -%} -->
